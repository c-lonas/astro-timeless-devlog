---
---

<div id="trello-suggestion-container" class="mx-auto w-1/3 p-4 bg-gray-200 rounded-lg">
  <div class="mb-6">
    <input id="card-title" type="text" placeholder="Enter Card Title" class="w-full p-2 mb-4 border border-gray-300 rounded-md" />
    <textarea id="card-description" placeholder="Enter Card Description" class="w-full p-2 border border-gray-300 rounded-md" rows="4"></textarea>
    <button id="add-card" class="mt-4 p-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">Add Card</button>
  </div>
</div>

<script type="module">
  const addCardButton = document.getElementById('add-card');
  const cardTitleInput = document.getElementById('card-title');
  const cardDescriptionInput = document.getElementById('card-description');

  addCardButton.addEventListener('click', async () => {
    const title = cardTitleInput.value;
    const description = cardDescriptionInput.value;

    if (title && description) {
      try {
        await addCardToSuggestionList(title, description);
        cardTitleInput.value = '';
        cardDescriptionInput.value = '';
      } catch (error) {
        console.error('Error adding card:', error);
      }
    } else {
      alert('Please provide both title and description');
    }
  });

  async function addCardToSuggestionList(title, description) {
    const SUGGESTION_LIST_ID = '659fe9527196c66c1a5a8dca';
    const TRELLO_API_KEY = import.meta.env.TRELLO_KEY;
    const TRELLO_TOKEN = import.meta.env.TRELLO_TOKEN;

    const url = `https://api.trello.com/1/cards?idList=${SUGGESTION_LIST_ID}&name=${encodeURIComponent(title)}&desc=${encodeURIComponent(description)}&key=${TRELLO_API_KEY}&token=${TRELLO_TOKEN}`;

    const response = await fetch(url, { method: 'POST' });
    if (!response.ok) {
      throw new Error('Failed to add card');
    }

    return response.json();
  }
</script>
